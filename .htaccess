# ============================================
# .htaccess - Rackhost verzió
# Magyarország Felfedezői Szövetség
# ============================================

RewriteEngine On
RewriteBase /

# ============================================
# MAIN PAGES ROUTING
# ============================================

# Prevent rewrite loops - skip if file exists
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Route: /rolunk → pages/about.php
RewriteRule ^rolunk/?$ pages/about.php [L,NC]

# Route: /kapcsolat → pages/contact.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^kapcsolat/?$ pages/contact.php [L,NC]

# Route: /jelvenyeink → pages/badges.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^jelvenyeink/?$ pages/badges.php [L,NC]

# Route: /muzeumunk → pages/museum.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^muzeumunk/?$ pages/museum.php [L,NC]

# Route: /videok → pages/videos.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^videok/?$ pages/videos.php [L,NC]

# ============================================
# TEAMS ROUTING
# ============================================

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^csapataink/harmasfalu/?$ pages/teams/harmasfalu.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^csapataink/kibed/?$ pages/teams/kibed.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^csapataink/sovarad/?$ pages/teams/sovarad.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^csapataink/felsoszeli/?$ pages/teams/felsoszeli.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^csapataink/mad/?$ pages/teams/mad.php [L,NC]

# ============================================
# NEWS ROUTING
# ============================================

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^hirek/?$ pages/news/index.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^hirek/([a-z0-9\-]+)/?$ pages/news/article.php?slug=$1 [L,NC,QSA]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^jelentkezes/?$ pages/news/registration.php [L,NC]

# ============================================
# GALLERY ROUTING
# ============================================

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^galeria/?$ pages/gallery/index.php [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^galeria/([0-9]{4})/([a-z\-]+)/?$ pages/gallery/album.php?year=$1&album=$2 [L,NC,QSA]

# ============================================
# SECURITY
# ============================================

Options -Indexes

<FilesMatch "^(config\.php|TemplateEngine\.php|news\.php)$">
    Order allow,deny
    Deny from all
</FilesMatch>

<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

# ============================================
# PERFORMANCE
# ============================================

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
</IfModule>

<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
</IfModule>